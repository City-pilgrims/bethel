{% extends 'base.html' %}
{% load bootstrap4 %}
{% load static %}

{% block content %}
    <style>
        .word-wrap {
            white-space: normal;       /* 줄 바꿈을 유지하되 단어가 길어지면 줄 바꿈 */
            word-wrap: break-word;       /* 긴 단어가 줄을 넘지 않도록 강제로 줄 바꿈 */
            word-break: keep-all;       /* 단어가 너무 길면 중간에서 강제로 줄 바꿈 */
        }

        .meditation-display {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: flex-start;
            margin: 2rem 0;
            margin-top: 2.5rem;
            flex-wrap: wrap;
            max-width: 550px;
            margin-left: auto;
            margin-right: auto;
            padding: 0.8rem;
            border-radius: 12px;
            background-color: darkgray;
        }

        .meditation-item {
            flex: 0 0 calc(50% - 5px);
            max-width: calc(50% - 5px);
            text-align: center;
        }

        .meditation-item img {
            max-width: 100%; /* 컨테이너를 넘지 않도록 */
            height: auto; /* 원본 비율 유지 */
            border-radius: 10px;
            margin-bottom: 5px;
            border: 2px solid #ddd;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .meditation-item video {
            max-width: 100%; /* 컨테이너를 넘지 않도록 */
            height: auto; /* 원본 비율 유지 */
            border-radius: 10px;
            border: 2px solid #ddd;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .meditation-item span {
            font-size: 0.9rem;
            color: #666;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .meditation-display {
                max-width: 400px;
                gap: 8px;
            }

            .meditation-item {
                flex: 0 0 calc(50% - 4px);
                max-width: calc(50% - 4px);
            }

            .meditation-item span {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .meditation-display {
                max-width: 350px;
                gap: 6px;
            }

            .meditation-item {
                flex: 0 0 calc(50% - 3px);
                max-width: calc(50% - 3px);
            }
        }
    </style>

    <div>

        {% if target_user.profile %}
            <img src="{{ target_user.profile.image.url }}" alt=""
            style="height: 12rem; width: 12rem; border-radius: 20rem; margin-bottom: 2rem; ">
            <h2 style="font-family: 'NanumSquareB'; color: #800020;">
                {{ target_user.profile.nickname }}
                {% if target_user == user %}
                    <a href="{% url 'profileapp:update' pk=target_user.profile.pk %}" style="color: green; font-size: 1rem;">
                        프로필 수정
                    </a>
                {% endif %}

            </h2>
            <div class="word-wrap">
                <p style="font-size: 1.1rem; margin-top: 1rem; margin-bottom: 2rem; margin-left: 1rem; margin-right: 1rem;">
                    {{ target_user.profile.message|linebreaksbr }}
                </p>
            </div>



        {% else %}
            {% if target_user == user %}
                <a href="{% url 'profileapp:create' %}" style="text-decoration-line: none;">
                    <h2 style="font-family: 'NanumSquareB'; margin-bottom: 1.5rem; color: #800020;">
                        프로필 생성
                    </h2>
                </a>
            {% else %}
                <h2>
                    로그인 하세요!!
                </h2>
            {% endif %}
        {% endif %}

        {% if target_user == user and user.is_authenticated and user.pk %}
            <a href="{% url 'accountapp:update' pk=user.pk %}" style="text-decoration-line: none; color: black;">
                ✏️정보 변경
            </a>
            &nbsp&nbsp
            <a href="{% url 'accountapp:logout' %}?next={% url 'accountapp:detail' pk=user.pk %}" style="text-decoration-line: none;">
                <img src="{% static 'icons8-logout-50.png' %}" alt="logout"
                     style="width: 20px; height: 20px; cursor: pointer;">
                <span style=" color: black;">로그아웃</span>
            </a>
        {% endif %}


        <!-- 묵상 파일들 표시 -->
        {% if target_user.profile.image_medfirst or target_user.profile.image_medsecond or target_user.profile.video_medthird %}
            <div class="meditation-display">
                {% if target_user.profile.image_medfirst %}
                    <div class="meditation-item">
                        <img src="{{ target_user.profile.image_medfirst.url }}" alt="묵상 이미지 1">
                    </div>
                {% endif %}

                {% if target_user.profile.image_medsecond %}
                    <div class="meditation-item">
                        <img src="{{ target_user.profile.image_medsecond.url }}" alt="묵상 이미지 2">
                    </div>
                {% endif %}

                {% if target_user.profile.video_medthird %}
                    <div class="meditation-item">
                        <video controls>
                            <source src="{{ target_user.profile.video_medthird.url }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                {% endif %}
            </div>
        {% endif %}
    </div>


{% endblock %}